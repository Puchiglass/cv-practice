# Практическая работа №3. Классификация изображений с использованием библиотеки OpenCV.

## Описание программы

Данная программа реализует классификацию изображений кошек и собак с использованием подхода "мешок слов" и классификатора SVM. Алгоритм обрабатывает изображения, извлекает дескрипторы SIFT, строит визуальные слова с помощью K-Means кластеризации и обучает модель классификации для определения принадлежности изображений к классу кошек или собак.

## Основные возможности:
### Загрузка и подготовка данных: 
Скачивание и извлечение датасета "Dogs vs Cats" с Kaggle.

### Обработка изображений: 
Изменение размера изображений, извлечение дескрипторов SIFT.

### Кластеризация дескрипторов: 
Построение визуального словаря с помощью MiniBatchKMeans.

### Обучение модели: 
Использование SVM с линейным ядром для обучения модели.

### Оценка качества: 
Вывод метрик классификации, построение гистограмм и визуализация ключевых точек изображений.

## Структура программы

Программа состоит из нескольких основных функций:

### 1. download_and_extract_data
Скачивает и распаковывает архив с данными из конкурса Kaggle. 

Параметры:
- kaggle_competition: Название соревнования на Kaggle.
- dataset_dir: Директория для сохранения данных.

### 2. prepare_train_test_split
Создает тренировочные и тестовые выборки с указанным количеством изображений.

Параметры:
- dataset_dir: Директория с извлеченными данными.
- train_dir: Директория для сохранения тренировочных данных.
- test_dir: Директория для сохранения тестовых данных.
- train_size: Количество тренировочных изображений каждого класса.
- test_size: Количество тестовых изображений каждого класса.

### 3. load_images_from_folder
Загружает изображения из указанной директории, изменяет их размер и возвращает массив изображений и их метки.

Параметры:
- folder: Путь к папке с изображениями.
- label: Метка класса для изображений.
- image_size: Размер изображений (по умолчанию 150x150).

### 4. extract_features_bag_of_words
Извлекает дескрипторы SIFT, кластеризует их с помощью K-Means и строит гистограммы визуальных слов для каждого изображения.

Параметры:
- images: Список изображений.
- n_clusters: Количество кластеров для K-Means.

Возвращает:
- Гистограммы признаков.
- Обученную модель K-Means.

### 5. visualize_histogram
Визуализирует гистограмму визуальных слов для одного изображения.

Параметры:
- hist: Гистограмма слов.
- title: Заголовок гистограммы.

### 6. main
Главная функция программы, которая выполняет весь процесс:

- Загружает данные.
- Создает тренировочную и тестовую выборки.
- Извлекает признаки с помощью алгоритма "мешок слов".
- Обучает классификатор SVM.
- Оценивает модель и визуализирует результаты.